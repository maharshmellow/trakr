<!DOCTYPE html>
<html lang="en">

<head>
    <title>Maharsh Patel</title>
    <meta charset="utf-8" /> {% load static %}
    <link rel="stylesheet" href="{% static 'trakr/css/bootstrap.min.css' %}" type="text/css" />
    <link rel="stylesheet" href="{% static 'trakr/css/fonts.css' %}" type="text/css" />
    <!-- <link rel="stylesheet" href="{% static 'trakr/css/styles.css' %}" type="text/css" /> -->
    <script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="{% static 'trakr/js/scripts.js' %}"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="display: none">
    <div id="backplate" class="container-fluid">
        <div class="row" id="mainRow">
            <div id="infoMessage"></div>
            <div class="col-md-1"></div>
            <div class="col-md-3" id="trakrLogoDiv">
                <img id="trakrLogo" class="img-responsive img-center undraggable" src="{% static 'trakr/images/svglogodark.svg' %}">
            </div>
            <div class="col-md-3">
                <!-- asdf -->
            </div>
            <div class="col-md-4 text-center" id="menu">
                <a href="javascript:signout()" class="menuitem">Logout</a>
                <a href="/status" class="menuitem">Status</a>
                <a href="/account" class="menuitem">Account</a>
                <a href="#" class="menuitem">Home</a>
            </div>
            <div class="col-md-1"></div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-10 col-md-push-1" id="websites">
                <!-- <div class="spacer1"></div> -->
                <div class="website">
                    <div class="col-md-4">
                        <div class="website_title">Jason Lang Scholarship</div>
                        <div class="website_value">http://ualberta.ca/jasonlang</div>
                    </div>
                    <div class="col-md-2">
                        <div class="modified_title">Last Modified</div>
                        <div class="modified_value">June 12, 2017</div>
                    </div>
                    <div class="col-md-2">
                        <div class="check_title">Last Checked</div>
                        <div class="check_value">July 15, 2017 9:30PM</div>
                    </div>
                    <div class="col-md-2">
                        <div class="services_title">Services</div>
                        <div class="services_value">Email, SMS, Slack, API</div>
                    </div>
                    <div class="col-md-1">
                        <div class="extra">
                            <img class="undraggable" src="{% static 'trakr/images/orb.svg' %}" style="padding-left: 10px;"></img>
                        </div>
                    </div>
                    <div class="col-md-1 center-block">
                        <div class="extra">
                            <input class="undraggable" type="image" src="{% static 'trakr/images/orb3.svg' %}" name="1111" style="padding-top:2px; padding-left: 20px; opacity: 0.3" onclick="editItem(this.name)" />
                        </div>
                    </div>
                    <!-- <div class="spacer1"></div> -->
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <hr>
                </div>
                <div class="col-md-1"></div>
                <div class="website">
                    <div class="col-md-4">
                        <div class="website_title">Jason Lang Scholarship</div>
                        <div class="website_value">http://ualberta.ca/jasonlang</div>
                    </div>
                    <div class="col-md-2 ">
                        <div class="modified_title">Last Modified</div>
                        <div class="modified_value">June 12, 2017</div>
                    </div>
                    <div class="col-md-2">
                        <div class="check_title">Last Checked</div>
                        <div class="check_value">July 15, 2017 9:30PM</div>
                    </div>
                    <div class="col-md-2">
                        <div class="services_title">Services</div>
                        <div class="services_value">Email, SMS, Slack, API</div>
                    </div>
                    <div class="col-md-1">
                        <div class="extra">
                            <img class="undraggable" src="{% static 'trakr/images/orb.svg' %}" style="padding-left: 10px;"></img>
                        </div>
                    </div>
                    <div class="col-md-1 center-block">
                        <div class="extra">
                            <input class="undraggable" type="image" src="{% static 'trakr/images/orb3.svg' %}" name="2222" style="padding-top:2px; padding-left: 20px; opacity: 0.3" onclick="editItem(this.name)" />
                        </div>
                    </div>
                    <!-- <div class="spacer1"></div> -->
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <hr>
                </div>
                <div class="col-md-1"></div>
                <div class="website">
                    <!-- <div class="spacer1"></div> -->
                    <div class="col-md-4">
                        <div class="website_title">Jason Lang Scholarship</div>
                        <div class="website_value">http://ualberta.ca/jasonlang</div>
                    </div>
                    <div class="col-md-2 ">
                        <div class="modified_title">Last Modified</div>
                        <div class="modified_value">June 12, 2017</div>
                    </div>
                    <div class="col-md-2">
                        <div class="check_title">Last Checked</div>
                        <div class="check_value">July 15, 2017 9:30PM</div>
                    </div>
                    <div class="col-md-2">
                        <div class="services_title">Services</div>
                        <div class="services_value">Email, SMS, Slack, API</div>
                    </div>
                    <div class="col-md-1">
                        <div class="extra">
                            <img class="undraggable" src="{% static 'trakr/images/orb.svg' %}" style="padding-left: 10px;"></img>
                        </div>
                    </div>
                    <div class="col-md-1 center-block">
                        <div class="extra">
                            <input class="undraggable" type="image" src="{% static 'trakr/images/orb3.svg' %}" name="3333" style="padding-top:2px; padding-left: 20px; opacity: 0.3" onclick="editItem(this.name)" />
                        </div>
                    </div>
                    <!-- <div class="spacer1"></div> -->
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <hr>
                </div>
                <div class="col-md-1"></div>
                <div class="website">
                    <!-- <div class="spacer1"></div> -->
                    <div class="col-md-4">
                        <div class="website_title">Jason Lang Scholarship</div>
                        <div class="website_value">http://ualberta.ca/jasonlang</div>
                    </div>
                    <div class="col-md-2 ">
                        <div class="modified_title">Last Modified</div>
                        <div class="modified_value">June 12, 2017</div>
                    </div>
                    <div class="col-md-2">
                        <div class="check_title">Last Checked</div>
                        <div class="check_value">July 15, 2017 9:30PM</div>
                    </div>
                    <div class="col-md-2">
                        <div class="services_title">Services</div>
                        <div class="services_value">Email, SMS, Slack, API</div>
                    </div>
                    <div class="col-md-1">
                        <div class="extra">
                            <img class="undraggable" src="{% static 'trakr/images/orb.svg' %}" style="padding-left: 10px;"></img>
                        </div>
                    </div>
                    <div class="col-md-1 center-block">
                        <div class="extra">
                            <input class="undraggable" type="image" src="{% static 'trakr/images/orb3.svg' %}" name="4444" style="padding-top:2px; padding-left: 20px; opacity: 0.3" onclick="editItem(this.name)" />
                        </div>
                    </div>
                    <!-- <div class="spacer1"></div> -->
                </div>
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <hr>
                </div>
                <div class="col-md-1"></div>
                <div class="website" id="abc">
                    <!-- <div class="spacer1"></div> -->
                    <div class="col-md-4">
                        <div class="website_title">Jason Lang Scholarship</div>
                        <div class="website_value">http://ualberta.ca/jasonlang</div>
                    </div>
                    <div class="col-md-2 ">
                        <div class="modified_title">Last Modified</div>
                        <div class="modified_value">June 12, 2017</div>
                    </div>
                    <div class="col-md-2">
                        <div class="check_title">Last Checked</div>
                        <div class="check_value">July 15, 2017 9:30PM</div>
                    </div>
                    <div class="col-md-2">
                        <div class="services_title">Services</div>
                        <div class="services_value">Email, SMS, Slack, API</div>
                    </div>
                    <div class="col-md-1">
                        <div class="extra">
                            <img class="undraggable" src="{% static 'trakr/images/orb.svg' %}" style="padding-left: 10px;"></img>
                        </div>
                    </div>
                    <div class="col-md-1 center-block">
                        <div class="extra">
                            <!-- TODO the name attribute here will be replaced with the id of the website for that particular user -->
                            <input class="undraggable" type="image" src="{% static 'trakr/images/orb3.svg' %}" name="5555" style="padding-top:2px; padding-left: 20px; opacity: 0.3" onclick="editItem(this.name)" />
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-md-1" style="background-color: grey">sdf</div> -->
        </div>
        <input id="addButton" class="undraggable center-block" type="image" style="padding-bottom:50px;"src="{% static 'trakr/images/add_button.svg' %}" name="5555" onclick="addWebsite()" />

        <div class="col-md-4 col-md-offset-4" id="add_item_menu" style="overflow: hidden; display: none; font-family:'trakr_text_semibold';">
          <br>
          <br>

          <div class="row">
            <div class="col-md-1 col-xs-2"></div>
            <div class="col-md-10 col-xs-8 text-center">
              <div id="add_item_label" style="float: left; padding-top:10px; ">Website Name</div>
              <input class="add_item_input" id="website_name_input"/>
            </div>
            <div class="col-md-1 col-xs-2"></div>
          </div>
          <div class="row">
            <div class="col-md-1 col-xs-2"></div>
            <div class="col-md-10 col-xs-8 text-center">
              <div id="add_item_label" style="float: left;padding-top:10px;">Website Url</div>
              <input class="add_item_input" id="website_url_input"/>
            </div>
            <div class="col-md-1"></div>
          </div>

          <div class="row">
            <div class="col-md-1 col-xs-2"></div>
            <div class="col-md-10 col-xs-8 text-center">
              <div id="add_item_label" style="float: left; padding-top:10px; " >Frequency</div>

            </div>
            <div class="col-md-1 col-xs-2"></div>
          </div>
          <br>

            <div class="row">
            <div id="fourcircle" class="row">
                <div class="col-xs-2 col-xs-2"></div>
                <div class="col-xs-2 text-center">
                    <img class="center-block frequencybut" id="selectfrequencybutton" name="1min" src="{% static 'trakr/images/checkbox_inactive.svg' %}" style="width: 25px;" onclick="hover(this,'frequencybut');"></img>
                    <div id="frequencyoption">1min</div>
                </div>

                <div class="col-xs-2 text-center">
                    <img class="center-block frequencybut" id="selectfrequencybutton" name="5min" src="{% static 'trakr/images/checkbox_inactive.svg' %}" style="width: 25px;"  onclick="hover(this,'frequencybut');"></img>
                  <div id="frequencyoption">5min</div>
                </div>
                <div class="col-xs-2 text-center">
                    <img class="center-block frequencybut" id="selectfrequencybutton" name="30min" src="{% static 'trakr/images/checkbox_inactive.svg' %}" style="width: 25px;"  onclick="hover(this,'frequencybut');"></img>
                    <div id="frequencyoption">30min</div>
                </div>
                <div class="col-xs-2 text-center">
                    <img class="center-block frequencybut" id="selectfrequencybutton" name="60min" src="{% static 'trakr/images/checkbox_inactive.svg' %}" style="width: 25px;"  onclick="hover(this,'frequencybut');"></img>

                    <div id="frequencyoption">60min</div>
                </div>
                <div class="col-xs-2 col-xs-2"></div>
              </div>
            </div>

          <div class="row">
            <div class="col-md-1 col-xs-2" ></div>
            <div id="add_item_label" class="col-md-10 col-xs-8">Notification</div>
            <div class="col-md-1 col-xs-2"></div>
          </div>

          <div class="row">
            <div class="col-md-1 col-xs-2"></div>
            <div class="col-md-10 col-xs-8">
              <div id="notification_option">
                  <img class="undraggable notification_option_button fourcircle" name="email1" src="{% static 'trakr/images/checkbox_inactive.svg' %}" onclick="hover(this,'fourcircle');"></img>
                  yzhao9@ualberta.ca
              </div>
              <div id="notification_option">
                  <img class="undraggable notification_option_button fourcircle"  name="email2"src="{% static 'trakr/images/checkbox_inactive.svg' %}" onclick="hover(this,'fourcircle');"></img>
                  yzhao9@ualberta.ca
              </div>
              <div id="notification_option">
                  <img class="undraggable notification_option_button fourcircle"   name="email3" src="{% static 'trakr/images/checkbox_inactive.svg' %}" onclick="hover(this,'fourcircle');"></img>
                  yzhao9@ualberta.ca
              </div>
              <div id="notification_option">
                  <img class="undraggable notification_option_button fourcircle"  name="email4" src="{% static 'trakr/images/checkbox_inactive.svg' %}" onclick="hover(this,'fourcircle');"></img>
                  yzhao9@ualberta.ca
              </div>
            </div>
            <div class="col-md-1 col-xs-2"></div>

          </div>

          <div class="row">
            <div class="col-md-1 col-xs-2"></div>
            <div class="col-md-10 col-xs-8 text-center">
              <div id="add_item_label" style="float: left; padding-top:10px;">Webhook(optional)</div>
              <input class="add_item_input" id="website_name_input"/>
            </div>
            <div class="col-md-1 col-xs-2"></div>
          </div>

          <button class="center-block" id="submitbutton" onclick="getInfo();">Submit</button>
          <br>
      </div>
    </div>
</body>
<style>

#submitbutton{
  margin-bottom: 10px;
  margin-top: 50px;
  background: #6F06FB;
  border-radius: 90px;
  outline:none;
  border: none;
  width: 180px;
  height: 40px;
  color: white;




}
#notification_option{
  padding-bottom: 4px;
}
#selectfrequencybutton{
  padding-bottom: 10px;
}
#frequencyoption{
  padding-bottom: 8px;
}
#add_item_menu {
    background-color: white;
    box-shadow: 0 0 8px 0 #D3D3D3;
}


.add_item_input {
    font-family: "trakr_text_regular";
    letter-spacing: -0.3;
    font-size: 17px;
    color: #A9A5BC;
    line-height: 3em;
    width: 100%;
    background-color: #FCFAFF;
    /*border: none;*/
    border-top: none;
    border-right: none;
    border-left: none;
    /*border-bottom: none;*/
    border-bottom-color: rgb(246, 238, 254);
    border-bottom-width: 1px;
}

.add_item_input:focus {
    outline: none;
}

body {
    margin: 0;
    padding: 2em;
    overflow-x: hidden;
    background-position: 0% 20%;
    padding-top: 10vh;
}

#backplate {
    padding: 0;
}

#trakrLogo {
    width: 150px;
}

#trakrLogoDiv {
    padding: 0;
}

#infoMessage {
    display: none;
    width: 100%;
    background-color: #6F06FB;
    color: white;
    font-family: "trakr_text_regular";
    font-size: 12px;
    padding: 10px;
    position: absolute;
    top: 0;
    left: 0;
}

#menu {
    height: 50px;
    padding: 0;
}

.menuitem {
    margin: 25px;
    float: right;
    margin-top: 7px;
    margin-right: 0;
    font-size: 12px;
    font-family: "trakr_text_semibold";
    letter-spacing: -0.3;
    color: #332E4D;
}

a {
    color: white;
}

a:hover {
    color: #6F06FB;
    text-decoration: none;
}


/*#mainrow {
    width: 100%;
}*/

#websites {
    background-color: #FCFAFF;
    /*height: 500px;*/
}

.website {
    /*min-height: 60px;*/
    line-height: 13px;
    /*padding: 25px;*/
    /*background-color: green;*/
}

.website_title,
.modified_title,
.check_title,
.services_title,
.extra {
    font-family: "trakr_text_semibold";
    font-size: 12px;
    letter-spacing: -0.3;
    /*padding-top: 8px;*/
    padding-top: 35px;
    color: #332E4D;
}

.extra {
    padding-left: 10px;
}

.website_value,
.modified_value,
.check_value,
.services_value {
    font-family: "trakr_text_regular";
    letter-spacing: -0.3;
    font-size: 12px;
    padding-bottom: 35px;
    color: #A9A5BC;
}

hr {
    margin: 0;
    border-color: rgb(246, 238, 254);

  }

#addButton {
    padding-top: 50px;
}

#addButton:focus {
    outline: 0;
}

.undraggable {
    user-drag: none;
    -moz-user-select: none;
    -webkit-user-drag: none;
}

.notification_option_button{
    padding-left: 20px;
    width: 30px;

}

</style>
<script type="text/javascript" src="http://beneposto.pl/jqueryrotate/js/jQueryRotateCompressed.js"></script>
<script>
var hidden = false;
function addWebsite(){

  if (!hidden){
     document.getElementById("add_item_menu").style.display="block";
    hidden = true;
    $("#addButton").rotate(45);
  }
  else{
     document.getElementById("add_item_menu").style.display="none";
    hidden = false;
    $("#addButton").rotate(90);
  }

}
if(!hidden){
$("#addButton").click(function() {
    $('html,body').animate({
        scrollTop: $("#add_item_menu").offset().top},
        500);
});
}


// function showsup(blank){
//   document.addEventListener("click", function (e) {
//   var level = 0;
//   for (var element = e.target; element; element = element.parentNode) {
//     if (element.id === 'addButton') {
//         console.log("5");
//         document.getElementById("add_item_menu").style.display="block";
//       return;
//     }
//     else if (element.id==="add_item_menu"){
//       return;
//     }
//     level++;
//   }
//
//   document.getElementById("add_item_menu").style.display="none";
// });
//
// }

var freq, email;
function hover(element,classname){
  // offclick();
  var circles=document.getElementsByClassName(classname);
  for(var i=0;i< circles.length;i+=1){
    circles[i].src="{% static 'trakr/images/checkbox_inactive.svg' %}";
  }

  var category = element.getAttribute('name');
  if(category.includes("min")){
    freq=category
  }
  if(category.includes("email")){
    email=category
  }
  console.log(email);
  console.log(freq);




  element.setAttribute('src',"{% static 'trakr/images/checkbox_active.svg' %}");

}
function editItem(itemId) {
    alert(itemId);
}

function addItem() {
    // display the page
}
firebase.auth().onAuthStateChanged(user => {
    if (user) {
        firebase.auth().currentUser.getIdToken().then(function(idToken) {
            // get the user data
            var formdata = new FormData();
            formdata.append("token", idToken);
            formdata.append("csrfmiddlewaretoken", getCookie("csrftoken"));
            console.log(getCookie("csrftoken"));
            $.ajax({
                type: 'POST',
                url: 'loadUserData',
                data: formdata,
                contentType: false,
                processData: false,
                success: function(data) {
                    var response = JSON.parse(data);

                    if (response.status == 0){
                        console.log("0")
                        signout();
                    }
                    console.log(response);
                    document.getElementsByTagName("body")[0].style.display = "block";
                },
            });


        }).catch(function(error) {
            signout();
        });
    }
    else{
        window.location.replace("/");
    }
});
var info=[];
function isUrlValid(url){
  var urlregex = /^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;
    return urlregex.test(url);
}



function getInfo(){
  var webname=document.getElementById("website_name_input").value;
  var url=document.getElementById("website_url_input").value;
  var webhook=document.getElementById("add_item_label").value;
  console.log("url "+ url);
  if(webname.length!=0 && url.length!=0 && isUrlValid(url) && email.length!=0 && freq.length!=0 ){
      console.log("test");
      info.push(webname);
      info.push(url);
      info.push(webhook);
      info.push(email);
      info.push(freq);

  }
  else{
    console.log("error");
  }






  console.log(info);



}

// firebase.auth().onAuthStateChanged(user => {
//     if (user) {
//         firebase.auth().currentUser.getIdToken().then(function(idToken) {
//             console.log(idToken);
//         }).catch(function(error) {
//             signout();
//         });
//     }
// });

// TODO need to get these values from the database and store it
//setInfoMessage("Notifications may be delayed - Experiencing Problems with SendGrid");


// check if the user is already logged in

//TODO DO A GET REQUEST FOR THE INFORMATION AND SEND THE TOKEN THERE FOR VERIFICATION
// firebase.auth().onAuthStateChanged(user => {
//     if (user) {
//         firebase.auth().currentUser.getIdToken().then(function(idToken) {

//             // TODO DO THE REQUEST HERE
//             // $.get("/home", ...

//             var info = "Email: " + user.email + "<br>ID:" + user.uid + "<br>Token:" + idToken;
//             document.getElementById("info").innerHTML = info;
//         }).catch(function(error) {
//             signout();
//         });
//     } else {
//         window.location.replace("/");
//     }
// });
</script>

</html>
